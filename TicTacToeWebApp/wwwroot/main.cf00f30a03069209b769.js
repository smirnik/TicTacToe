(()=>{"use strict";var e={552:(e,t,i)=>{e.exports=i.p+"images/crown.svg"}},t={};function i(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,i),a.exports}i.m=e,i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");o.length&&(e=o[o.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),i.b=document.baseURI||self.location.href,(()=>{const e="#ef476f",t="#118ab2",o="#a9adb3",n="black",a=Object.freeze({nothing:0,x:1,o:2}),s=new Map([["waitingForSecondPlayer","Waiting for the second player"],["started","Game started"],["aborted","Game aborted"],["finnished","Game finnished"]]);class r{#e;#t;#i;#o;#n;#a;#s;#r;#l;constructor(s,r){this.#h(),this.#e=Array(9).fill(0),this.#s=new class{constructor(e,t,i,o){this.#e=t,this.#d(),this.#c=i,this.#u=o,this.mark=a.Nothing,this.#g(e)}#m;#e;#c;#u;#p;#v;#f;#b;#M;#y;#w;#x;#k;#E;#S=10;#C=2;#P=4;#_=6;#L=5;#T;#D;#N;#O;#I=8;#R;#B;#A;setPlayerNames(e,t){this.#p=e,this.#v=t,this.#W(a.nothing)}setCurrentMarkMove(e){this.#W(e)}setGameResult(e){e.winningCells&&3===e.winningCells.length&&this.#z(e.winningCells[0],e.winningCells[2]);var t=a[e.winner];this.#W(t,e.isDraw,t)}setMark(e,t){const{row:i,col:o}=this.#H(t);this.#$(e,i,o)}setGameStatus(e){"waitingForSecondPlayer"===e&&this.#F("Waiting...")}#F(e,t){const i=Math.min(Math.trunc(this.#N/3),42),o=Math.trunc(this.#D+this.#O/2),n=Math.trunc(this.#T+this.#N/2);this.#m.font=`${i}px sans-serif`,this.#m.fillStyle=t??"black",this.#m.textBaseline="middle",this.#m.textAlign="center",this.#m.save();const a=this.#m.measureText(e).width,s=Math.trunc(a/2);this.#m.fillStyle="rgba(0, 187, 255, 0.6)",this.#m.fillRect(o-s-5,n-Math.trunc(i/2)-5,a+10,i+10),this.#m.restore(),this.#m.fillText(e,o,n)}#g(e){var t=e.getContext("2d");this.#m=t,this.#f=t.canvas.width,this.#b=t.canvas.height;const i=Math.min(this.#b-this.#f,120);let o=Math.min(this.#f,this.#b-i);const n=Math.trunc((this.#b-i-o)/2);this.#T=n+this.#L,this.#N=i-2*this.#L,this.#D=this.#L,this.#O=this.#f-2*this.#L,o-=2*this.#S,this.#w=this.#S+i,this.#k=this.#w+o,this.#x=Math.trunc((this.#f-o)/2),this.#E=this.#x+o,this.#M=Math.trunc(o/3),this.#y=Math.trunc(.2*this.#M),this.#G(e),this.#j(),this.#W(a.nothing)}#d(){this.#A=new Promise(((e,t)=>{const o=new Image(42,42);o.addEventListener("load",(t=>{e(o)}));let n=new URL(i(552),i.b);o.src=n}))}async#W(i,s,r){this.#m.clearRect(this.#D,this.#T,this.#O,this.#N);const l=Math.min(Math.trunc(.1*this.#N),10),h=Math.trunc(this.#O/2),d=Math.trunc(this.#O/4),c=Math.min(Math.trunc((this.#N-l)/3),40),u=Math.min(Math.trunc(.6*(this.#N-c-l)),h,42),g=Math.trunc(u/6*4),m=g+u+c+l,p=this.#T+Math.trunc((this.#N-m)/2),v=Math.trunc(d-u/2);let f=p+g,b=i===a.x||s?e:o;if(this.#K(this.#D+v,f,u,this.#I,b),b=i===a.o||s?t:o,this.#V(this.#D+h+v,f,u,this.#I,b),f+=u+l,this.#p){const e=!s&&i===a.x;b=i===a.x||s||r===a.x?n:o,this.#X(this.#p,this.#D+Math.trunc(h/2),f,c,b,e)}if(this.#v){const e=!s&&i===a.o;b=i===a.o||s||r===a.o?n:o,this.#X(this.#v,this.#D+h+Math.trunc(h/2),f,c,b,e)}if(s){let e=await this.#A;this.#m.drawImage(e,this.#D+h-Math.trunc(g/2),Math.trunc((p+m)/2),g,g)}else if(r){const e=r===a.x?Math.trunc(this.#D+d-g/2):Math.trunc(this.#D+h+d-g/2);let t=await this.#A;this.#m.drawImage(t,e,p,g,g)}}#X(e,t,i,o,n,a){if(this.#m.font=`${o}px sans-serif`,this.#m.fillStyle=n??"black",this.#m.textBaseline="top",this.#m.textAlign="center",this.#m.fillText(e,t,i),a){const n=Math.trunc(this.#m.measureText(e).width/2);this.#m.beginPath(),this.#m.lineWidth=2,this.#m.strokeStyle="#FFB900",this.#m.moveTo(t-n,i+o),this.#m.lineTo(t+n,i+o),this.#m.stroke()}}#K(t,i,o,n,a=e){this.#m.beginPath(),this.#m.lineCap="round",this.#m.strokeStyle=a,this.#m.lineWidth=n,this.#m.beginPath(),this.#m.moveTo(t,i),this.#m.lineTo(t+o,i+o),this.#m.moveTo(t+o,i),this.#m.lineTo(t,i+o),this.#m.stroke()}#V(e,i,o,n,a=t){const s=Math.trunc(o/2);this.#m.beginPath(),this.#m.strokeStyle=a,this.#m.lineWidth=n,this.#m.arc(e+s,i+s,s,0,2*Math.PI),this.#m.stroke()}#G(e){e.addEventListener("mouseleave",(e=>{this.#R>=0&&this.#e[this.#R]===a.nothing&&this.#U(this.#R),this.#R=void 0})),e.addEventListener("mousemove",(e=>{this.#Y(e)})),e.addEventListener("mousedown",(e=>{const t=this.#q(e.offsetX,e.offsetY);t&&this.#u(t.cell)&&(this.#B=t.cell)})),e.addEventListener("mouseup",(e=>{const t=this.#q(e.offsetX,e.offsetY);t&&this.#B===t.cell&&this.#u(t.cell)&&this.#c(t.cell),this.#B=void 0}))}#Y(e){const t=e.offsetX,i=e.offsetY;let o,n,s;const r=this.#q(t,i);r&&({row:o,col:n,cell:s}=r),this.#u()&&this.#R!=s&&this.#R>=0&&this.#e[this.#R]===a.nothing&&this.#U(this.#R),s>=0&&this.#u(s)?(this.#$(this.mark,o,n,"#ffd166"),this.#R=s):this.#R=void 0}#q(e,t){if(e>this.#x&&e<this.#E&&t>this.#w&&t<this.#k){const i=Math.trunc((e-this.#x)/this.#M),o=Math.trunc((t-this.#w)/this.#M);return{row:o,col:i,cell:Math.trunc(3*o+i)}}return null}#$(e,t,i,o){Math.trunc(this.#P/2);const n=this.#x+i*this.#M+this.#y,s=this.#w+t*this.#M+this.#y,r=this.#M-2*this.#y;e==a.x?this.#K(n,s,r,this.#P,o):this.#V(n,s,r,this.#P,o)}#H(e){return{row:Math.trunc(e/3),col:e%3}}#U(e){const{row:t,col:i}=this.#H(e),o=this.#x+i*this.#M+this.#y-this.#P,n=this.#w+t*this.#M+this.#y-this.#P,a=this.#M-2*this.#y+2*this.#P;this.#m.clearRect(o,n,a,a)}#j(){let e,t;this.#m.beginPath(),this.#m.lineCap="round",this.#m.lineWidth=this.#C,this.#m.strokeStyle="#073b4c";for(let t=1;t<=2;t++)e=this.#x+this.#M*t,this.#m.moveTo(e,this.#w),this.#m.lineTo(e,this.#k);for(let e=1;e<=2;e++)t=this.#w+this.#M*e,this.#m.moveTo(this.#x,t),this.#m.lineTo(this.#E,t);this.#m.stroke()}#J(e,t){return{x:this.#x+t*this.#M+Math.trunc(this.#M/2),y:this.#w+e*this.#M+Math.trunc(this.#M/2)}}#z(e,t){const{row:i,col:o}=this.#H(e),{row:n,col:a}=this.#H(t),{x:s,y:r}=this.#J(i,o),{x:l,y:h}=this.#J(n,a);this.#m.beginPath(),this.#m.strokeStyle="rgba(6, 214, 160, 0.7)",this.#m.lineWidth=this.#_,this.#m.lineCap="round",this.#m.moveTo(s,r),this.#m.lineTo(l,h),this.#m.stroke()}}(s,this.#e,this.#c.bind(this),this.#u.bind(this)),this.#a=new class{#Z;constructor(e){this.#Z=e}addChatMessage(e,t){const i=`<p class="chat-message">${this.#Q()} <span class="chat-message-name">${e}:</span> <span>${t}</span></p>`;this.#ee(i)}addInfo(e){const t=`<p class="chat-message chat-message-info">${this.#Q()} <span>${e}</span></p>`;this.#ee(t)}addWarning(e){const t=`<p class="chat-message chat-message-warning">${this.#Q()} <span>${e}</span></p>`;this.#ee(t)}#Q(){return`<span class="chat-message-time">[${(new Date).toLocaleTimeString()}]</span>`}#ee(e){this.#Z.insertAdjacentHTML("beforeend",e)}}(r)}connect(e){this.#t=e,this.#n=new class{#te;constructor(e){this.#te=new WebSocket(`wss://${window.location.host}/ws`),this.#te.onopen=t=>{e("connected",t)},this.#te.onmessage=function(t){if(e){let{eventType:i,eventData:o}=JSON.parse(t.data);if(e&&o){const t=JSON.parse(o);e(i,t)}}},this.#te.onerror=function(t){console.error("connection error: "+t),e&&e("connectionError",t)},this.#te.onclose=function(t){e&&e&&e("disconnected",t)}}disconnect(){this.#te.close()}sendMove(e,t){this.#ie("Move",{cell:e,mark:t})}sendChatMessage(e){this.#ie("ChatMessage",{message:e})}sendReady(e){this.#ie("PlayerReady",{playerName:e})}#ie(e,t){if(this.#te.readyState!==WebSocket.OPEN)throw new Error("Connection status is not open");const i=JSON.stringify({eventType:e,eventData:JSON.stringify(t)});this.#te.send(i)}}(this.#oe.bind(this))}sendChatMessage(e){this.#n.sendChatMessage(e)}ready(e,t){this.#l=t,this.#n.sendReady(e)}#h(){this.#o=new Map,this.#o.set("chatMessage",this.#ne),this.#o.set("connected",this.#ae),this.#o.set("error",this.#se),this.#o.set("move",this.#re),this.#o.set("nextMove",this.#le),this.#o.set("setMark",this.#he),this.#o.set("status",this.#de),this.#o.set("playerLeaved",this.#ce),this.#o.set("disconnected",this.#ue),this.#o.set("connectionError",this.#ge)}#oe(e,t){const i=this.#o.get(e);i?i.bind(this)(t):console.log(`Didn't found handler for ${e} event`)}#ae(e){this.#t&&this.#t(),this.#a.addInfo("Connection established")}#ue(e){this.#a.addWarning("Disconnected")}#ge(e){this.#a.addWarning(`Error occured: ${e}`)}#se(e){console.log(`Error occured: ${e.message}`),"invalidPlayerData"===e.errorType&&this.#l&&this.#l(e.message)}#ne(e){console.log(`Chat: [${e.senderName}] ${e.message}`),this.#a.addChatMessage(e.senderName,e.message)}#de(e){console.log(`Game status: ${e.gameStatus}`);const t=s.get(e.gameStatus);void 0!==t&&this.#a.addInfo(t),"finnished"===e.gameStatus?this.#me(e.statusObject):"started"===e.gameStatus?this.#pe(e.statusObject):"aborted"===e.gameStatus&&this.#ve(e.statusObject),this.#s.setGameStatus(e.gameStatus)}#pe(e){let t,i;e.forEach(((e,o)=>{a[e.mark]===a.o?i=e.name:t=e.name})),this.#s.setPlayerNames(t,i)}#ve(e){this.#a.addWarning("Game has been interrupted")}#me(e){this.#i=a.nothing,this.#s.setGameResult(e),e.isDraw?this.#a.addInfo("Draw"):e.winner&&this.#a.addInfo(`'${e.winner.toUpperCase()}' won the game`)}#le(e){console.log(`Next move: ${e.mark}`),this.#i=a[e.mark],this.#s.setCurrentMarkMove(this.#i)}#re(e){console.log(`Moved: ${e.mark} - ${e.cell}`);const t=a[e.mark];this.#e[e.cell]=t,this.#s.setMark(t,e.cell)}#he(e){console.log(`Mark assigned: ${e.mark}`),this.#s.mark=this.#r=a[e.mark]}#c(e){if(console.log(`Moved: ${e}`),!this.#u(e))throw new Error("Cannot move");this.#n.sendMove(e,Object.keys(a)[this.#r])}#ce(e){this.#a.addWarning(`Player '${e.name}' left the game`)}#u(e){let t=void 0!==this.#i&&this.#i!==a.nothing&&this.#i==this.#r;return void 0===e?t:t&&this.#e[e]===a.nothing}}var l=window.CustomEvent;function h(e,t){var i="on"+t.type.toLowerCase();return"function"==typeof e[i]&&e[i](t),e.dispatchEvent(t)}function d(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement?e.parentElement:e.parentNode?e.parentNode.host:null}return null}function c(e){for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;e&&e.blur&&e!==document.body&&e.blur()}function u(e,t){for(var i=0;i<e.length;++i)if(e[i]===t)return!0;return!1}function g(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function m(e){var t=["button","input","keygen","select","textarea"].map((function(e){return e+":not([disabled])"}));t.push('[tabindex]:not([disabled]):not([tabindex=""])');var i=e.querySelector(t.join(", "));if(!i&&"attachShadow"in Element.prototype)for(var o=e.querySelectorAll("*"),n=0;n<o.length&&!(o[n].tagName&&o[n].shadowRoot&&(i=m(o[n].shadowRoot)));n++);return i}function p(e){return e.isConnected||document.body.contains(e)}function v(e){if(e.submitter)return e.submitter;var t=e.target;if(!(t instanceof HTMLFormElement))return null;var i=M.formSubmitter;if(!i){var o=e.target;i=("getRootNode"in o&&o.getRootNode()||document).activeElement}return i&&i.form===t?i:null}function f(e){if(!e.defaultPrevented){var t=e.target,i=M.imagemapUseValue,o=v(e);null===i&&o&&(i=o.value);var n=d(t);n&&"dialog"===(o&&o.getAttribute("formmethod")||t.getAttribute("method"))&&(e.preventDefault(),null!=i?n.close(i):n.close())}}function b(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),e.addEventListener("submit",f,!1),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window)new MutationObserver(this.maybeHideModal.bind(this)).observe(e,{attributes:!0,attributeFilter:["open"]});else{var t,i=!1,o=function(){i?this.downgradeModal():this.maybeHideModal(),i=!1}.bind(this),n=function(n){if(n.target===e){var a="DOMNodeRemoved";i|=n.type.substr(0,a.length)===a,window.clearTimeout(t),t=window.setTimeout(o,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach((function(t){e.addEventListener(t,n)}))}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}l&&"object"!=typeof l||((l=function(e,t){t=t||{};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail||null),i}).prototype=window.Event.prototype),b.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&p(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),M.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var t=document.createElement("div");this.dialog_.insertBefore(t,this.dialog_.firstChild),t.tabIndex=-1,t.focus(),this.dialog_.removeChild(t)}var i=document.createEvent("MouseEvents");i.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(i),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),e||(e=m(this.dialog_)),c(document.activeElement),e&&e.focus()},updateZIndex:function(e,t){if(e<t)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=t},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!p(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!M.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var t=window.getComputedStyle(e),i=function(e,i){return!(void 0===t[e]||t[e]===i)};if(t.opacity<1||i("zIndex","auto")||i("transform","none")||i("mixBlendMode","normal")||i("filter","none")||i("perspective","none")||"isolate"===t.isolation||"fixed"===t.position||"touch"===t.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,M.needsCentering(this.dialog_)?(M.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(e){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==e&&(this.dialog_.returnValue=e);var t=new l("close",{bubbles:!1,cancelable:!1});h(this.dialog_,t)}};var M={reposition:function(e){var t=document.body.scrollTop||document.documentElement.scrollTop,i=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,i)+"px"},isInlinePositionSetByStylesheet:function(e){for(var t=0;t<document.styleSheets.length;++t){var i=document.styleSheets[t],o=null;try{o=i.cssRules}catch(e){}if(o)for(var n=0;n<o.length;++n){var a=o[n],s=null;try{s=document.querySelectorAll(a.selectorText)}catch(e){}if(s&&u(s,e)){var r=a.style.getPropertyValue("top"),l=a.style.getPropertyValue("bottom");if(r&&"auto"!==r||l&&"auto"!==l)return!0}}}return!1},needsCentering:function(e){return!("absolute"!==window.getComputedStyle(e).position||"auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom||M.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new b(e)},registerDialog:function(e){e.showModal||M.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(t){this.forwardTab_=void 0,t.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver((function(t){var i=[];t.forEach((function(e){for(var t,o=0;t=e.removedNodes[o];++o)t instanceof Element&&("dialog"===t.localName&&i.push(t),i=i.concat(t.querySelectorAll("dialog")))})),i.length&&e(i)})))}};if(M.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},M.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},M.DialogManager.prototype.updateStacking=function(){for(var e,t=this.zIndexHigh_,i=0;e=this.pendingDialogStack[i];++i)e.updateZIndex(--t,--t),0===i&&(this.overlay.style.zIndex=--t);var o=this.pendingDialogStack[0];o?(o.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},M.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=d(e);){for(var t,i=0;t=this.pendingDialogStack[i];++i)if(t.dialog===e)return 0===i;e=e.parentElement}return!1},M.DialogManager.prototype.handleFocus_=function(e){var t=e.composedPath?e.composedPath()[0]:e.target;if(!this.containedByTopDialog_(t)&&document.activeElement!==document.documentElement&&(e.preventDefault(),e.stopPropagation(),c(t),void 0!==this.forwardTab_)){var i=this.pendingDialogStack[0];return i.dialog.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?i.focus_():t!==document.documentElement&&document.documentElement.focus()),!1}},M.DialogManager.prototype.handleKey_=function(e){if(this.forwardTab_=void 0,27===e.keyCode){e.preventDefault(),e.stopPropagation();var t=new l("cancel",{bubbles:!1,cancelable:!0}),i=this.pendingDialogStack[0];i&&h(i.dialog,t)&&i.dialog.close()}else 9===e.keyCode&&(this.forwardTab_=!e.shiftKey)},M.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach((function(t){-1!==e.indexOf(t.dialog)?t.downgradeModal():t.maybeHideModal()}))},M.DialogManager.prototype.pushDialog=function(e){var t=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=t||(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),0))},M.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);-1!==t&&(this.pendingDialogStack.splice(t,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},M.dm=new M.DialogManager,M.formSubmitter=null,M.imagemapUseValue=null,void 0===window.HTMLDialogElement){var y=document.createElement("form");if(y.setAttribute("method","dialog"),"dialog"!==y.method){var w=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(w){var x=w.get;w.get=function(){return g(this)?"dialog":x.call(this)};var k=w.set;w.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):k.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",w)}}document.addEventListener("click",(function(e){if(M.formSubmitter=null,M.imagemapUseValue=null,!e.defaultPrevented){var t=e.target;if("composedPath"in e&&(t=e.composedPath().shift()||t),t&&g(t.form)){if(!("submit"===t.type&&["button","input"].indexOf(t.localName)>-1)){if("input"!==t.localName||"image"!==t.type)return;M.imagemapUseValue=e.offsetX+","+e.offsetY}d(t)&&(M.formSubmitter=t)}}}),!1),document.addEventListener("submit",(function(e){var t=e.target;if(!d(t)){var i=v(e);"dialog"===(i&&i.getAttribute("formmethod")||t.getAttribute("method"))&&e.preventDefault()}}));var E=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!g(this))return E.call(this);var e=d(this);e&&e.close()}}const S=M;function C(){const e=document.getElementById("gameCanvas"),t=document.getElementById("gameMessages"),i=document.getElementById("startDialog");S.registerDialog(i);const o=document.getElementById("dialogName"),n=document.getElementById("chatInput"),a=document.getElementById("sendBtn"),s=document.getElementById("dialogErrorMessage"),l=new r(e,t);a.addEventListener("click",(e=>{const t=n.value;void 0!==t&&t.length>0&&(l.sendChatMessage(n.value),n.value="")})),n.addEventListener("keydown",(e=>{13==e.keyCode&&(l.sendChatMessage(n.value),n.value="")})),l.connect((()=>i.showModal())),i.addEventListener("close",(e=>{o.value?l.ready(o.value,(e=>{s.innerText=e,i.showModal()})):i.showModal()}))}"loading"!==document.readyState?C():document.addEventListener("DOMContentLoaded",(()=>C()))})()})();